import{r as t,f as D,j as s,h as _,u as S,C as j,R as E,d as B,L as f,e as C}from"./index-64dcebe6.js";import{i as P,j as y,k as R,l as $}from"./index-21da7072.js";import{C as N}from"./Card-37aa5091.js";import"./iconBase-42b2867d.js";const g=t.forwardRef(({bsPrefix:a,bg:r="primary",pill:l=!1,text:o,className:p,as:d="span",...m},c)=>{const u=D(a,"badge");return s.jsx(d,{ref:c,...m,className:_(p,u,l&&"rounded-pill",o&&`text-${o}`,r&&`bg-${r}`)})});g.displayName="Badge";const F=g;const H=()=>{const{t:a}=S(),[r,l]=t.useState([]),[o,p]=t.useState(!0),[d,m]=t.useState(null),[c,u]=t.useState(null);t.useEffect(()=>{const e=localStorage.getItem("userData");e&&u(JSON.parse(e))},[]);const b=async()=>{var e,n;try{m(null);const i=await C.get("http://localhost:4000/api/purchases");l(i.data.purchases||[])}catch(i){console.error("Error fetching purchases:",i),m(((n=(e=i.response)==null?void 0:e.data)==null?void 0:n.message)||a("common.error_occurred")),l([])}finally{p(!1)}},v=e=>{const n=new Date,h=new Date(e)-n,x=Math.ceil(h/(1e3*60*60*24));return x<0?a("purchases.expired"):x===0?a("purchases.expires_today"):a("purchases.days_remaining",{days:x})},w=e=>{const n=new Date,h=new Date(e)<n;return s.jsx(F,{bg:h?"danger":"success",className:"status-badge",children:a(h?"purchases.expired":"purchases.active")})};return t.useEffect(()=>{b()},[]),o?s.jsx(j,{className:"purchases-container",children:s.jsx("div",{className:"text-center py-5",children:s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:a("common.loading")})})})}):d?s.jsx(j,{className:"purchases-container",children:s.jsx("div",{className:"text-center py-5",children:s.jsx("div",{className:"alert alert-danger",role:"alert",children:d})})}):s.jsx(j,{className:"purchases-container py-5",children:s.jsx(E,{className:"justify-content-center",children:s.jsx(B,{md:8,children:s.jsxs(N,{className:"purchases-card",children:[s.jsxs(N.Header,{className:"text-center",children:[s.jsx("h2",{children:a("purchases.title")}),s.jsx("p",{className:"text-muted mb-0",children:c!=null&&c.name?a("purchases.subtitle_with_name",{name:c.name}):a("purchases.subtitle")})]}),s.jsx(N.Body,{children:r!=null&&r.length?s.jsx("div",{className:"purchases-list",children:r.map(e=>s.jsxs("div",{className:"purchase-item",children:[s.jsx("div",{className:"purchase-thumbnail",children:s.jsx("img",{src:e.content.thumbnail_url,alt:e.content.title})}),s.jsxs("div",{className:"purchase-info",children:[s.jsxs("div",{className:"purchase-header",children:[s.jsx("h5",{children:e.content.title}),w(e.expiryDate)]}),s.jsxs("div",{className:"purchase-details",children:[s.jsxs("p",{className:"purchase-date",children:[s.jsx(y,{className:"icon"}),a("purchases.purchased_on"),":"," ",new Date(e.purchaseDate).toLocaleDateString()]}),s.jsxs("p",{className:"purchase-price",children:[s.jsx(R,{className:"icon"}),a("purchases.amount"),": â‚¹",e.amount]}),s.jsxs("p",{className:"purchase-expiry",children:[s.jsx(y,{className:"icon"}),v(e.expiryDate)]})]}),s.jsxs(f,{to:`/movie/${e.content._id}`,className:"btn btn-primary btn-sm watch-button",children:[s.jsx($,{className:"me-2"}),a("purchases.watch_now")]})]})]},e._id))}):s.jsxs("div",{className:"text-center py-4",children:[s.jsx(P,{className:"no-purchases-icon"}),s.jsx("p",{className:"mt-3",children:a("purchases.no_purchases")}),s.jsx(f,{to:"/",className:"btn btn-primary mt-2",children:a("purchases.browse_movies")})]})})]})})})})};export{H as default};
