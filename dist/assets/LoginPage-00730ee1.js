import{r as f,m as U,c as s,a as Y,D as Z,j as b,i as ee,E as te}from"./index-9684c524.js";function ne(e={}){const{nonce:a,onScriptLoadSuccess:r,onScriptLoadError:c}=e,[n,t]=f.useState(!1),o=f.useRef(r);o.current=r;const i=f.useRef(c);return i.current=c,f.useEffect(()=>{const u=document.createElement("script");return u.src="https://accounts.google.com/gsi/client",u.async=!0,u.defer=!0,u.nonce=a,u.onload=()=>{var l;t(!0),(l=o.current)===null||l===void 0||l.call(o)},u.onerror=()=>{var l;t(!1),(l=i.current)===null||l===void 0||l.call(i)},document.body.appendChild(u),()=>{document.body.removeChild(u)}},[a]),n}const q=f.createContext(null);function oe({clientId:e,nonce:a,onScriptLoadSuccess:r,onScriptLoadError:c,children:n}){const t=ne({nonce:a,onScriptLoadSuccess:r,onScriptLoadError:c}),o=f.useMemo(()=>({clientId:e,scriptLoadedSuccessfully:t}),[e,t]);return U.createElement(q.Provider,{value:o},n)}function ie(){const e=f.useContext(q);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function re(e){var a;return(a=e==null?void 0:e.clientId)!==null&&a!==void 0?a:e==null?void 0:e.client_id}const ce={large:40,medium:32,small:20};function ae({onSuccess:e,onError:a,useOneTap:r,promptMomentNotification:c,type:n="standard",theme:t="outline",size:o="large",text:i,shape:u,logo_alignment:l,width:d,locale:_,click_listener:E,containerProps:g,...v}){const p=f.useRef(null),{clientId:F,scriptLoadedSuccessfully:C}=ie(),L=f.useRef(e);L.current=e;const m=f.useRef(a);m.current=a;const B=f.useRef(c);return B.current=c,f.useEffect(()=>{var S,y,h,D,N,R,x,A,G;if(C)return(h=(y=(S=window==null?void 0:window.google)===null||S===void 0?void 0:S.accounts)===null||y===void 0?void 0:y.id)===null||h===void 0||h.initialize({client_id:F,callback:w=>{var O;if(!(w!=null&&w.credential))return(O=m.current)===null||O===void 0?void 0:O.call(m);const{credential:P,select_by:X}=w;L.current({credential:P,clientId:re(w),select_by:X})},...v}),(R=(N=(D=window==null?void 0:window.google)===null||D===void 0?void 0:D.accounts)===null||N===void 0?void 0:N.id)===null||R===void 0||R.renderButton(p.current,{type:n,theme:t,size:o,text:i,shape:u,logo_alignment:l,width:d,locale:_,click_listener:E}),r&&((G=(A=(x=window==null?void 0:window.google)===null||x===void 0?void 0:x.accounts)===null||A===void 0?void 0:A.id)===null||G===void 0||G.prompt(B.current)),()=>{var w,O,P;r&&((P=(O=(w=window==null?void 0:window.google)===null||w===void 0?void 0:w.accounts)===null||O===void 0?void 0:O.id)===null||P===void 0||P.cancel())}},[F,C,r,n,t,o,i,u,l,d,_]),U.createElement("div",{...g,ref:p,style:{height:ce[o],...g==null?void 0:g.style}})}var z={},k={},$={},I={},T={};Object.defineProperty(T,"__esModule",{value:!0});T.createScriptEle=void 0;const le=(e,a)=>new Promise(r=>{var c;const t=document.getElementsByTagName("script")[0];if(document.getElementById(e)){r(void 0);return}const o=document.createElement("script");if(o.id=e,o.src=a,o.onload=r,t)(c=t.parentNode)===null||c===void 0||c.insertBefore(o,t);else{const i=document.body.childNodes;document.body.insertBefore(o,i.item(i.length-1))}});T.createScriptEle=le;var J={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.paramsToObject=e.objectToParams=e.isObject=void 0;const a=n=>Object.prototype.toString.call(n)==="[object Object]";e.isObject=a;const r=n=>!(0,e.isObject)(n)||Object.keys(n).length===0?"":"?"+Object.keys(n).map(t=>`${t}=${encodeURIComponent(n[t])}`).join("&");e.objectToParams=r;const c=n=>(n==null?void 0:n.replace(/^\?/,"").split("&").reduce((t,o)=>{if(!o)return t;const[i,u]=o.split("=");return Object.assign(Object.assign({},t),{[i]:decodeURIComponent(u)})},{}))||{};e.paramsToObject=c})(J);var M={};Object.defineProperty(M,"__esModule",{value:!0});M.isFacebookApp=void 0;const ue=()=>{if(typeof window>"u")return!1;const e=navigator.userAgent||navigator.vendor||window.opera;return e.indexOf("FBAN")>-1||e.indexOf("FBAV")>-1||e.indexOf("Instagram")>-1};M.isFacebookApp=ue;(function(e){var a=s&&s.__createBinding||(Object.create?function(c,n,t,o){o===void 0&&(o=t);var i=Object.getOwnPropertyDescriptor(n,t);(!i||("get"in i?!n.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(c,o,i)}:function(c,n,t,o){o===void 0&&(o=t),c[o]=n[t]}),r=s&&s.__exportStar||function(c,n){for(var t in c)t!=="default"&&!Object.prototype.hasOwnProperty.call(n,t)&&a(n,c,t)};Object.defineProperty(e,"__esModule",{value:!0}),r(T,e),r(J,e),r(M,e)})(I);(function(e){var a=s&&s.__awaiter||function(n,t,o,i){function u(l){return l instanceof o?l:new o(function(d){d(l)})}return new(o||(o=Promise))(function(l,d){function _(v){try{g(i.next(v))}catch(p){d(p)}}function E(v){try{g(i.throw(v))}catch(p){d(p)}}function g(v){v.done?l(v.value):u(v.value).then(_,E)}g((i=i.apply(n,t||[])).next())})},r=s&&s.__rest||function(n,t){var o={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(o[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,i=Object.getOwnPropertySymbols(n);u<i.length;u++)t.indexOf(i[u])<0&&Object.prototype.propertyIsEnumerable.call(n,i[u])&&(o[i[u]]=n[i[u]]);return o};Object.defineProperty(e,"__esModule",{value:!0}),e.FacebookLoginClient=e.SDK_SCRIPT_ELE_ID=void 0;const c=I;e.SDK_SCRIPT_ELE_ID="facebook-jssdk",e.FacebookLoginClient={getFB:()=>window.FB?window.FB:(console.warn("FB not found"),null),getLoginStatus(n,t=!1){const o=this.getFB();if(!o){n({status:"unknown"});return}o.getLoginStatus(n,t)},getProfile(n,t){var o;(o=this.getFB())===null||o===void 0||o.api("me",t,n)},init(n){var t;(t=this.getFB())===null||t===void 0||t.init(n)},clear(){window.FB=null;const n=document.getElementById(e.SDK_SCRIPT_ELE_ID);n&&n.remove()},isRedirected(n){var t,o;const i=(0,c.paramsToObject)(window.location.search);return((t=i.state===(n==null?void 0:n.state))!==null&&t!==void 0?t:"facebookdirect")&&i[(o=n==null?void 0:n.response_type)!==null&&o!==void 0?o:""]!==void 0},loadSdk(n,t){return a(this,void 0,void 0,function*(){yield(0,c.createScriptEle)(e.SDK_SCRIPT_ELE_ID,`https://connect.facebook.net/${n}/sdk${t?"/xfbml.customerchat":""}.js`)})},redirectToDialog(n,t){var o=r(t,["ignoreSdkError"]);window.location.href=`https://www.facebook.com/dialog/oauth${(0,c.objectToParams)(Object.assign(Object.assign({},n),o))}`},login(n,t){var o,{ignoreSdkError:i}=t,u=r(t,["ignoreSdkError"]);try{(o=this.getFB())===null||o===void 0||o.login(n,u)}catch(l){if(i)return;throw l}},logout(n){this.getLoginStatus(t=>{var o;t.status==="connected"?(o=this.getFB())===null||o===void 0||o.logout(n):n()})}}})($);var de=s&&s.__createBinding||(Object.create?function(e,a,r,c){c===void 0&&(c=r);var n=Object.getOwnPropertyDescriptor(a,r);(!n||("get"in n?!a.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return a[r]}}),Object.defineProperty(e,c,n)}:function(e,a,r,c){c===void 0&&(c=r),e[c]=a[r]}),se=s&&s.__setModuleDefault||(Object.create?function(e,a){Object.defineProperty(e,"default",{enumerable:!0,value:a})}:function(e,a){e.default=a}),fe=s&&s.__importStar||function(e){if(e&&e.__esModule)return e;var a={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&de(a,e,r);return se(a,e),a},ge=s&&s.__awaiter||function(e,a,r,c){function n(t){return t instanceof r?t:new r(function(o){o(t)})}return new(r||(r=Promise))(function(t,o){function i(d){try{l(c.next(d))}catch(_){o(_)}}function u(d){try{l(c.throw(d))}catch(_){o(_)}}function l(d){d.done?t(d.value):n(d.value).then(i,u)}l((c=c.apply(e,a||[])).next())})};Object.defineProperty(k,"__esModule",{value:!0});const K=fe(f),j=$,ve=I;function _e(e){var a,r;const{appId:c,language:n="en_US",scope:t="public_profile, email",fields:o="name,email,picture",onSuccess:i,onFail:u,onProfileSuccess:l,className:d,style:_,children:E="Login with Facebook",render:g,autoLoad:v=!1,useRedirect:p=!1,useCustomerChat:F=!1}=e,C=Object.assign(Object.assign({version:"v9.0",xfbml:!1,cookie:!1,localStorage:!0},e.initParams),{appId:c}),L=Object.assign(Object.assign({redirect_uri:typeof window<"u"?location.origin+location.pathname:"/",state:"facebookdirect",response_type:"code"},e.dialogParams),{client_id:c}),m=Object.assign(Object.assign({return_scopes:!1,ignoreSdkError:!1},e.loginOptions),{auth_nonce:typeof((a=e.loginOptions)===null||a===void 0?void 0:a.auth_nonce)=="function"?e.loginOptions.auth_nonce():(r=e.loginOptions)===null||r===void 0?void 0:r.auth_nonce,scope:t});(0,K.useEffect)(()=>{B()},[]);const B=()=>ge(this,void 0,void 0,function*(){yield j.FacebookLoginClient.loadSdk(n,F),window.fbAsyncInit=()=>{j.FacebookLoginClient.init(C);const h=j.FacebookLoginClient.isRedirected(L);if(h===!1&&v){y();return}h===!0&&p&&S()}}),S=()=>{j.FacebookLoginClient.login(h=>{if(!h.authResponse){u&&u({status:"loginCancelled"});return}i&&i(h.authResponse),l&&j.FacebookLoginClient.getProfile(l,{fields:o})},Object.assign(Object.assign({},m),{scope:t}))},y=()=>{if((0,ve.isFacebookApp)()||p){j.FacebookLoginClient.redirectToDialog(L,m);return}if(!window.FB){u&&u({status:"facebookNotLoaded"});return}S()};return g?g({onClick:y,logout:j.FacebookLoginClient.logout}):K.default.createElement("button",{type:"button",onClick:y,className:d,style:_},E)}k.default=_e;var V={},H={};Object.defineProperty(H,"__esModule",{value:!0});var W={};Object.defineProperty(W,"__esModule",{value:!0});var Q={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LoginStatus=void 0,function(a){a.Connected="connected",a.NotAuthorized="not_authorized",a.Unknown="unknown"}(e.LoginStatus||(e.LoginStatus={}))})(Q);(function(e){var a=s&&s.__createBinding||(Object.create?function(c,n,t,o){o===void 0&&(o=t);var i=Object.getOwnPropertyDescriptor(n,t);(!i||("get"in i?!n.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(c,o,i)}:function(c,n,t,o){o===void 0&&(o=t),c[o]=n[t]}),r=s&&s.__exportStar||function(c,n){for(var t in c)t!=="default"&&!Object.prototype.hasOwnProperty.call(n,t)&&a(n,c,t)};Object.defineProperty(e,"__esModule",{value:!0}),r(H,e),r(W,e),r(Q,e)})(V);(function(e){var a=s&&s.__createBinding||(Object.create?function(t,o,i,u){u===void 0&&(u=i);var l=Object.getOwnPropertyDescriptor(o,i);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[i]}}),Object.defineProperty(t,u,l)}:function(t,o,i,u){u===void 0&&(u=i),t[u]=o[i]}),r=s&&s.__exportStar||function(t,o){for(var i in t)i!=="default"&&!Object.prototype.hasOwnProperty.call(o,i)&&a(o,t,i)},c=s&&s.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=c(k);r(I,e),r(V,e),r(k,e),r($,e),e.default=n.default})(z);const be=Y(z);const pe=f.memo(()=>{const e=Z(),a="534755738662-aaan7ti8cb2haqk5ma1celu6tg2kr23a.apps.googleusercontent.com",r="489246357076757",c=async l=>(await fetch("http://localhost:4000/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credential:l})})).json(),n=async l=>(await fetch("http://localhost:4000/auth/facebook",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessToken:l})})).json(),t=l=>{try{e(l)}catch(d){console.error("Navigation error:",d)}},o=async l=>{try{const d=await c(l.credential);localStorage.setItem("jwtToken",d.token),window.dispatchEvent(new Event("authChange")),t("/")}catch(d){console.error("Error:",d)}},i=()=>{console.log("Login Failed")},u=async l=>{try{const d=await n(l.accessToken);localStorage.setItem("jwtToken",d.token),window.dispatchEvent(new Event("authChange")),t("/")}catch(d){console.error("Error:",d)}};return b.jsx(ee,{fluid:!0,className:"login-container",children:b.jsxs("div",{className:"login-card text-center",children:[b.jsx(te,{}),b.jsx("h1",{className:"login-title",children:"Welcome Back"}),b.jsx("p",{className:"login-subtitle",children:"Sign in to start streaming"}),b.jsx(oe,{clientId:a,children:b.jsx("div",{className:"google-login-wrapper",children:b.jsx(ae,{onSuccess:o,onError:i,shape:"rectangular",logo_alignment:"left",width:"250px"})})}),b.jsx("div",{className:"facebook-login-wrapper",children:b.jsx(be,{appId:r,onSuccess:u,onFail:l=>{console.log("Login Failed!",l)},onProfileSuccess:l=>{console.log("Get Profile Success!",l)},style:{backgroundColor:"#4267b2",color:"#fff",fontSize:"16px",padding:"12px 24px",border:"none",borderRadius:"2px",height:"44px",width:"270px"},children:"Login with Facebook"})})]})})});pe.displayName="LoginPage";export{pe as default};
